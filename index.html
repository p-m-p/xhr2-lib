<html>
<head>
  <title>XHR2 Library</title>
  <style>
    
    #progress-outer { width: 400px; border: solid 1px silver }
    #progress-inner { width: 0; height: 5px; background-color: orange }
    
  </style>
</head>
<body>
  
  <header>
    
    <h1>XHR 2 Demos and Documentation</h1>
    
  </header>
        
    <form action="test/server.php" method="post" id="test-form">
      
      <div>
        <input id="name" type="text" name="name" value="">
        <label for="name">Name</label>
      </div>
      
      <div>
        <input id="email" type="text" name="email" value="">
        <label for="email">Email</label>
      </div>
      
      <div>
        <input type="submit" name="test" value="Send">
      </div>
      
    </form>
    
    <form action="" method="post">
      
      <input type="file" id="file-field" name="upload" multiple>
      
      <div id="progress-outer">
        <div id="progress-inner"></div>
      </div>
      
    </form>
    
  </section>
  
  <script src="src/xhr2lib.js"></script>
  <script>
  
    (function () {
      
      var tf = document.getElementById("test-form")
        , sf = document.getElementById("file-field")
        , up = document.getElementById("progress-inner");
      
      tf.addEventListener("submit", function (ev) {
      
        ev.preventDefault();
      
        $xhr.postForm(tf, function (res) {
          
          var elem = document.createElement('p');
          elem.innerHTML = res;
          tf.appendChild(elem);
          
        });
      
      }, false);
      
      sf.addEventListener("change", function (ev) {
        
        ev.preventDefault();
        
        $xhr.postFile(
          
            "test/server.php?isFile"
            
          , document.getElementById("file-field").files[0]
          
          , function success(res) {
            
              up.style.backgroundColor = "#0F0";
              up.style.width = "100%";
              
            }
            
          , function progress(pct) {
              
              up.style.width = pct + "%";
              
            }
            
          , "text"
          
        );
        
      });
    
    })();
    
  </script>
</body>
</html>
